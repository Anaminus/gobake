# gobake

`gobake` is a command-line program for embedding the content of files within a
Go program.

## Installation

1. [Install Go](https://golang.org/doc/install)
2. [Install Git](https://git-scm.com/downloads)
3. Using a shell with Git (such as Git Bash), run the following command:

```
go get -u github.com/anaminus/gobake
```

If you configured Go correctly, this will install gobake to `$GOPATH/bin`,
which will allow you run it directly from a shell.

## Usage

```bash
gobake [options] [file]
```

Reads from stdin if `file` is omitted.

Option             | Default        | Description
-------------------|----------------|------------
`-decl string`     | `"func"`       | How to declare the value. Can be `func`, `const`, or `var`.
`-compress string` | `""`           | How to compress the value. Can be empty, or `gzip`.
`-export`          | `false`        | Whether the declaration should be exported.
`-import string`   | `""`           | An optional package to import. Usually combined with `-type`.
`-name string`     | `""`           | The name of the declared value. Defaults to the name of the input file.
`-output string`   | `""`           | The name of the generated file. Writes to stdout if empty.
`-package string`  | `""`           | The name of the package. Determined by output location if empty, or "main" if all else fails.
`-type string`     | `"string"`     | The type of the declared value. Must be convertable to a string.

### Declaration types
Data can be written in one of several declaration types specified by the `-decl`
option.

#### `var`
Writes the value as a variable declaration.

```go
var name = ...
```

#### `const`
Writes the value as a constant declaration.

```go
const name = ...
```

#### `func`
Writes the value as a function that returns an io.ReadCloser.

```go
func name() io.ReadCloser {
	...
}
```

### Types
When the declaration is a variable, the `-type` option specifies the value type.
This may be of any type that is convertible to a `string`. The `-import` option
should be included if the type must be imported from elsewhere.

### Compression
Data may be compressed with the `-compress` option. If compression is enabled,
the io.ReadCloser returned by the function declaration automatically
decompresses the data. Other declaration types must be decompressed manually.

The following formats are defined for compression:

- none
- `gzip`

### Naming
The name of the declaration is determined by the `-name` option, or otherwise by
the base name of the input file, without the extension.

Non-letters are stripped off the front of the name, and any other non-letters
are converted to `_`. The first letter will be uppercase if the `-export` option
is specified, and lowercase otherwise.

## Examples

#### Default
```bash
echo -n hello world | gobake
```
```go
// File generated by "gobake"
// DO NOT EDIT!

package main

import (
	"io"
	"ioutil"
	"strings"
)

func stdin() io.ReadCloser {
	const a = "\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64"
	return ioutil.NopCloser(strings.NewReader(a))
}

```

#### GZIP compression
```bash
echo -n hello world | gobake -compress gzip
```
```go
// File generated by "gobake -compress gzip"
// DO NOT EDIT!

package main

import (
	"gzip"
	"io"
	"strings"
)

func stdin() io.ReadCloser {
	const a = "" +
		"\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\xff\xca\x48\xcd\xc9\xc9\x57" +
		"\x28\xcf\x2f\xca\x49\x01\x04\x00\x00\xff\xff\x85\x11\x4a\x0d\x0b" +
		"\x00\x00\x00"
	gr, _ := gzip.NewReader(strings.NewReader(a))
	return gr
}
```

#### Constant with custom name
```bash
echo -n hello world | gobake -decl const -name message
```
```go
// File generated by "gobake -decl const -name message"
// DO NOT EDIT!

package main

const message = "\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64"
```

#### Exported variable with custom type
```bash
echo -n hello world | gobake -decl var -type []byte -name message -export
```
```go
// File generated by "gobake -decl var -type []byte -name message -export"
// DO NOT EDIT!

package main

var Message = []byte("\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64")
```
